{
  "best_metric": 0.9884386463511081,
  "best_model_checkpoint": "/home/azureuser/ruben/toxicity_classificator/checkpoints/microsoft/deberta-v3-base/run_1/fold_1/checkpoint-6500",
  "epoch": 1.6290726817042607,
  "eval_steps": 500,
  "global_step": 6500,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 0.02506265664160401,
      "grad_norm": 0.6462611556053162,
      "learning_rate": 9.916457811194654e-06,
      "loss": 0.3037,
      "step": 100
    },
    {
      "epoch": 0.05012531328320802,
      "grad_norm": 1.2974328994750977,
      "learning_rate": 9.832915622389308e-06,
      "loss": 0.0931,
      "step": 200
    },
    {
      "epoch": 0.07518796992481203,
      "grad_norm": 0.30440759658813477,
      "learning_rate": 9.749373433583961e-06,
      "loss": 0.067,
      "step": 300
    },
    {
      "epoch": 0.10025062656641603,
      "grad_norm": 0.559998095035553,
      "learning_rate": 9.665831244778615e-06,
      "loss": 0.0601,
      "step": 400
    },
    {
      "epoch": 0.12531328320802004,
      "grad_norm": 0.5639117360115051,
      "learning_rate": 9.582289055973267e-06,
      "loss": 0.0573,
      "step": 500
    },
    {
      "epoch": 0.12531328320802004,
      "eval_loss": 0.04947277903556824,
      "eval_roc_auc_macro": 0.9663276597347129,
      "eval_runtime": 205.299,
      "eval_samples_per_second": 155.456,
      "eval_steps_per_second": 4.861,
      "step": 500
    },
    {
      "epoch": 0.15037593984962405,
      "grad_norm": 0.35979995131492615,
      "learning_rate": 9.49874686716792e-06,
      "loss": 0.0525,
      "step": 600
    },
    {
      "epoch": 0.17543859649122806,
      "grad_norm": 0.3304809033870697,
      "learning_rate": 9.415204678362574e-06,
      "loss": 0.0457,
      "step": 700
    },
    {
      "epoch": 0.20050125313283207,
      "grad_norm": 1.1869689226150513,
      "learning_rate": 9.331662489557227e-06,
      "loss": 0.0465,
      "step": 800
    },
    {
      "epoch": 0.22556390977443608,
      "grad_norm": 0.6173519492149353,
      "learning_rate": 9.24812030075188e-06,
      "loss": 0.0526,
      "step": 900
    },
    {
      "epoch": 0.2506265664160401,
      "grad_norm": 0.18206138908863068,
      "learning_rate": 9.164578111946534e-06,
      "loss": 0.0474,
      "step": 1000
    },
    {
      "epoch": 0.2506265664160401,
      "eval_loss": 0.04610871896147728,
      "eval_roc_auc_macro": 0.9745653218945246,
      "eval_runtime": 205.1329,
      "eval_samples_per_second": 155.582,
      "eval_steps_per_second": 4.865,
      "step": 1000
    },
    {
      "epoch": 0.2756892230576441,
      "grad_norm": 1.025065541267395,
      "learning_rate": 9.081035923141188e-06,
      "loss": 0.0545,
      "step": 1100
    },
    {
      "epoch": 0.3007518796992481,
      "grad_norm": 0.6202341318130493,
      "learning_rate": 8.997493734335841e-06,
      "loss": 0.0469,
      "step": 1200
    },
    {
      "epoch": 0.3258145363408521,
      "grad_norm": 1.1130238771438599,
      "learning_rate": 8.913951545530493e-06,
      "loss": 0.0459,
      "step": 1300
    },
    {
      "epoch": 0.3508771929824561,
      "grad_norm": 0.5722708702087402,
      "learning_rate": 8.830409356725146e-06,
      "loss": 0.044,
      "step": 1400
    },
    {
      "epoch": 0.37593984962406013,
      "grad_norm": 0.49108585715293884,
      "learning_rate": 8.7468671679198e-06,
      "loss": 0.0501,
      "step": 1500
    },
    {
      "epoch": 0.37593984962406013,
      "eval_loss": 0.0471925362944603,
      "eval_roc_auc_macro": 0.9682662962109913,
      "eval_runtime": 205.1658,
      "eval_samples_per_second": 155.557,
      "eval_steps_per_second": 4.864,
      "step": 1500
    },
    {
      "epoch": 0.40100250626566414,
      "grad_norm": 0.3196794092655182,
      "learning_rate": 8.663324979114453e-06,
      "loss": 0.0456,
      "step": 1600
    },
    {
      "epoch": 0.42606516290726815,
      "grad_norm": 0.11863163858652115,
      "learning_rate": 8.579782790309107e-06,
      "loss": 0.0456,
      "step": 1700
    },
    {
      "epoch": 0.45112781954887216,
      "grad_norm": 0.9046522974967957,
      "learning_rate": 8.49624060150376e-06,
      "loss": 0.0476,
      "step": 1800
    },
    {
      "epoch": 0.47619047619047616,
      "grad_norm": 0.2639510929584503,
      "learning_rate": 8.412698412698414e-06,
      "loss": 0.0462,
      "step": 1900
    },
    {
      "epoch": 0.5012531328320802,
      "grad_norm": 0.2847878038883209,
      "learning_rate": 8.329156223893067e-06,
      "loss": 0.0455,
      "step": 2000
    },
    {
      "epoch": 0.5012531328320802,
      "eval_loss": 0.04637666419148445,
      "eval_roc_auc_macro": 0.9804766264459954,
      "eval_runtime": 205.2285,
      "eval_samples_per_second": 155.51,
      "eval_steps_per_second": 4.863,
      "step": 2000
    },
    {
      "epoch": 0.5263157894736842,
      "grad_norm": 1.9132806062698364,
      "learning_rate": 8.24561403508772e-06,
      "loss": 0.0489,
      "step": 2100
    },
    {
      "epoch": 0.5513784461152882,
      "grad_norm": 1.8408458232879639,
      "learning_rate": 8.162071846282373e-06,
      "loss": 0.0418,
      "step": 2200
    },
    {
      "epoch": 0.5764411027568922,
      "grad_norm": 0.3813645839691162,
      "learning_rate": 8.078529657477026e-06,
      "loss": 0.0423,
      "step": 2300
    },
    {
      "epoch": 0.6015037593984962,
      "grad_norm": 0.38753965497016907,
      "learning_rate": 7.99498746867168e-06,
      "loss": 0.0432,
      "step": 2400
    },
    {
      "epoch": 0.6265664160401002,
      "grad_norm": 0.9511359333992004,
      "learning_rate": 7.911445279866333e-06,
      "loss": 0.0445,
      "step": 2500
    },
    {
      "epoch": 0.6265664160401002,
      "eval_loss": 0.044242002069950104,
      "eval_roc_auc_macro": 0.980249103749281,
      "eval_runtime": 205.304,
      "eval_samples_per_second": 155.452,
      "eval_steps_per_second": 4.861,
      "step": 2500
    },
    {
      "epoch": 0.6516290726817042,
      "grad_norm": 0.579149603843689,
      "learning_rate": 7.827903091060987e-06,
      "loss": 0.0436,
      "step": 2600
    },
    {
      "epoch": 0.6766917293233082,
      "grad_norm": 0.46819376945495605,
      "learning_rate": 7.74436090225564e-06,
      "loss": 0.0457,
      "step": 2700
    },
    {
      "epoch": 0.7017543859649122,
      "grad_norm": 0.23659227788448334,
      "learning_rate": 7.660818713450294e-06,
      "loss": 0.0409,
      "step": 2800
    },
    {
      "epoch": 0.7268170426065163,
      "grad_norm": 0.4696936011314392,
      "learning_rate": 7.577276524644946e-06,
      "loss": 0.0382,
      "step": 2900
    },
    {
      "epoch": 0.7518796992481203,
      "grad_norm": 0.5377135872840881,
      "learning_rate": 7.4937343358396e-06,
      "loss": 0.0475,
      "step": 3000
    },
    {
      "epoch": 0.7518796992481203,
      "eval_loss": 0.03993920236825943,
      "eval_roc_auc_macro": 0.982596133089718,
      "eval_runtime": 205.3243,
      "eval_samples_per_second": 155.437,
      "eval_steps_per_second": 4.861,
      "step": 3000
    },
    {
      "epoch": 0.7769423558897243,
      "grad_norm": 0.5446147322654724,
      "learning_rate": 7.410192147034253e-06,
      "loss": 0.0456,
      "step": 3100
    },
    {
      "epoch": 0.8020050125313283,
      "grad_norm": 0.4714881181716919,
      "learning_rate": 7.326649958228906e-06,
      "loss": 0.0376,
      "step": 3200
    },
    {
      "epoch": 0.8270676691729323,
      "grad_norm": 0.6221947073936462,
      "learning_rate": 7.2431077694235595e-06,
      "loss": 0.046,
      "step": 3300
    },
    {
      "epoch": 0.8521303258145363,
      "grad_norm": 0.4750659167766571,
      "learning_rate": 7.159565580618213e-06,
      "loss": 0.039,
      "step": 3400
    },
    {
      "epoch": 0.8771929824561403,
      "grad_norm": 0.17179065942764282,
      "learning_rate": 7.0760233918128665e-06,
      "loss": 0.037,
      "step": 3500
    },
    {
      "epoch": 0.8771929824561403,
      "eval_loss": 0.04065064340829849,
      "eval_roc_auc_macro": 0.9816433448952994,
      "eval_runtime": 205.3863,
      "eval_samples_per_second": 155.39,
      "eval_steps_per_second": 4.859,
      "step": 3500
    },
    {
      "epoch": 0.9022556390977443,
      "grad_norm": 0.4570457935333252,
      "learning_rate": 6.992481203007519e-06,
      "loss": 0.0431,
      "step": 3600
    },
    {
      "epoch": 0.9273182957393483,
      "grad_norm": 0.41508936882019043,
      "learning_rate": 6.908939014202173e-06,
      "loss": 0.04,
      "step": 3700
    },
    {
      "epoch": 0.9523809523809523,
      "grad_norm": 0.273226797580719,
      "learning_rate": 6.825396825396826e-06,
      "loss": 0.037,
      "step": 3800
    },
    {
      "epoch": 0.9774436090225563,
      "grad_norm": 0.56902015209198,
      "learning_rate": 6.74185463659148e-06,
      "loss": 0.0383,
      "step": 3900
    },
    {
      "epoch": 1.0025062656641603,
      "grad_norm": 0.19390276074409485,
      "learning_rate": 6.658312447786132e-06,
      "loss": 0.0444,
      "step": 4000
    },
    {
      "epoch": 1.0025062656641603,
      "eval_loss": 0.043360378593206406,
      "eval_roc_auc_macro": 0.9857970132103823,
      "eval_runtime": 205.5964,
      "eval_samples_per_second": 155.231,
      "eval_steps_per_second": 4.854,
      "step": 4000
    },
    {
      "epoch": 1.0275689223057645,
      "grad_norm": 0.6875386238098145,
      "learning_rate": 6.574770258980786e-06,
      "loss": 0.0381,
      "step": 4100
    },
    {
      "epoch": 1.0526315789473684,
      "grad_norm": 0.31718528270721436,
      "learning_rate": 6.491228070175439e-06,
      "loss": 0.0389,
      "step": 4200
    },
    {
      "epoch": 1.0776942355889725,
      "grad_norm": 0.5100399851799011,
      "learning_rate": 6.407685881370093e-06,
      "loss": 0.0381,
      "step": 4300
    },
    {
      "epoch": 1.1027568922305764,
      "grad_norm": 0.26596739888191223,
      "learning_rate": 6.324143692564746e-06,
      "loss": 0.0377,
      "step": 4400
    },
    {
      "epoch": 1.1278195488721805,
      "grad_norm": 0.45226147770881653,
      "learning_rate": 6.240601503759399e-06,
      "loss": 0.0377,
      "step": 4500
    },
    {
      "epoch": 1.1278195488721805,
      "eval_loss": 0.03864317387342453,
      "eval_roc_auc_macro": 0.9853447776721521,
      "eval_runtime": 205.4757,
      "eval_samples_per_second": 155.322,
      "eval_steps_per_second": 4.857,
      "step": 4500
    },
    {
      "epoch": 1.1528822055137844,
      "grad_norm": 0.26236748695373535,
      "learning_rate": 6.1570593149540525e-06,
      "loss": 0.0368,
      "step": 4600
    },
    {
      "epoch": 1.1779448621553885,
      "grad_norm": 0.543797492980957,
      "learning_rate": 6.073517126148706e-06,
      "loss": 0.0358,
      "step": 4700
    },
    {
      "epoch": 1.2030075187969924,
      "grad_norm": 0.43131184577941895,
      "learning_rate": 5.9899749373433595e-06,
      "loss": 0.0379,
      "step": 4800
    },
    {
      "epoch": 1.2280701754385965,
      "grad_norm": 0.49564361572265625,
      "learning_rate": 5.906432748538012e-06,
      "loss": 0.0441,
      "step": 4900
    },
    {
      "epoch": 1.2531328320802004,
      "grad_norm": 0.46927568316459656,
      "learning_rate": 5.822890559732666e-06,
      "loss": 0.0384,
      "step": 5000
    },
    {
      "epoch": 1.2531328320802004,
      "eval_loss": 0.03923441469669342,
      "eval_roc_auc_macro": 0.9870105764630795,
      "eval_runtime": 205.4431,
      "eval_samples_per_second": 155.347,
      "eval_steps_per_second": 4.858,
      "step": 5000
    },
    {
      "epoch": 1.2781954887218046,
      "grad_norm": 0.6518852710723877,
      "learning_rate": 5.739348370927319e-06,
      "loss": 0.0333,
      "step": 5100
    },
    {
      "epoch": 1.3032581453634084,
      "grad_norm": 0.2820775806903839,
      "learning_rate": 5.655806182121973e-06,
      "loss": 0.0364,
      "step": 5200
    },
    {
      "epoch": 1.3283208020050126,
      "grad_norm": 0.2614823281764984,
      "learning_rate": 5.572263993316625e-06,
      "loss": 0.0392,
      "step": 5300
    },
    {
      "epoch": 1.3533834586466165,
      "grad_norm": 0.5945349931716919,
      "learning_rate": 5.488721804511279e-06,
      "loss": 0.0389,
      "step": 5400
    },
    {
      "epoch": 1.3784461152882206,
      "grad_norm": 0.40094953775405884,
      "learning_rate": 5.405179615705932e-06,
      "loss": 0.0367,
      "step": 5500
    },
    {
      "epoch": 1.3784461152882206,
      "eval_loss": 0.04265239089727402,
      "eval_roc_auc_macro": 0.9872078044043047,
      "eval_runtime": 205.3551,
      "eval_samples_per_second": 155.414,
      "eval_steps_per_second": 4.86,
      "step": 5500
    },
    {
      "epoch": 1.4035087719298245,
      "grad_norm": 0.38368239998817444,
      "learning_rate": 5.321637426900586e-06,
      "loss": 0.0426,
      "step": 5600
    },
    {
      "epoch": 1.4285714285714286,
      "grad_norm": 0.8160765767097473,
      "learning_rate": 5.2380952380952384e-06,
      "loss": 0.0377,
      "step": 5700
    },
    {
      "epoch": 1.4536340852130325,
      "grad_norm": 0.3017675578594208,
      "learning_rate": 5.154553049289892e-06,
      "loss": 0.0359,
      "step": 5800
    },
    {
      "epoch": 1.4786967418546366,
      "grad_norm": 0.7643914222717285,
      "learning_rate": 5.0710108604845454e-06,
      "loss": 0.034,
      "step": 5900
    },
    {
      "epoch": 1.5037593984962405,
      "grad_norm": 0.2023078203201294,
      "learning_rate": 4.987468671679198e-06,
      "loss": 0.0362,
      "step": 6000
    },
    {
      "epoch": 1.5037593984962405,
      "eval_loss": 0.03940431773662567,
      "eval_roc_auc_macro": 0.9863235961449496,
      "eval_runtime": 205.3858,
      "eval_samples_per_second": 155.39,
      "eval_steps_per_second": 4.859,
      "step": 6000
    },
    {
      "epoch": 1.5288220551378446,
      "grad_norm": 0.19223031401634216,
      "learning_rate": 4.903926482873852e-06,
      "loss": 0.0315,
      "step": 6100
    },
    {
      "epoch": 1.5538847117794488,
      "grad_norm": 0.39131325483322144,
      "learning_rate": 4.820384294068505e-06,
      "loss": 0.0389,
      "step": 6200
    },
    {
      "epoch": 1.5789473684210527,
      "grad_norm": 0.43873295187950134,
      "learning_rate": 4.736842105263158e-06,
      "loss": 0.0373,
      "step": 6300
    },
    {
      "epoch": 1.6040100250626566,
      "grad_norm": 0.5421969890594482,
      "learning_rate": 4.653299916457811e-06,
      "loss": 0.0377,
      "step": 6400
    },
    {
      "epoch": 1.6290726817042607,
      "grad_norm": 0.5870125889778137,
      "learning_rate": 4.569757727652465e-06,
      "loss": 0.0338,
      "step": 6500
    },
    {
      "epoch": 1.6290726817042607,
      "eval_loss": 0.04171842709183693,
      "eval_roc_auc_macro": 0.9884386463511081,
      "eval_runtime": 205.4631,
      "eval_samples_per_second": 155.332,
      "eval_steps_per_second": 4.857,
      "step": 6500
    }
  ],
  "logging_steps": 100,
  "max_steps": 11970,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 3,
  "save_steps": 500,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 3,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 2.736186573341491e+16,
  "train_batch_size": 32,
  "trial_name": null,
  "trial_params": null
}
